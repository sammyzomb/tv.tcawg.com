<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HERO å½±ç‰‡çµ±ä¸€ç®¡ç†ç³»çµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            background: transparent;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            color: #7f8c8d;
            transition: all 0.3s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .tab:hover:not(.active) {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            min-height: 600px;
        }

        .tab-content.active {
            display: block;
        }

        .overview-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .stat-card p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .video-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .video-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .video-thumbnail {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }

        .video-info {
            padding: 20px;
        }

        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .status-available {
            background: #d4edda;
            color: #155724;
        }

        .status-unavailable {
            background: #f8d7da;
            color: #721c24;
        }

        .status-checking {
            background: #fff3cd;
            color: #856404;
        }

        .status-suspended {
            background: #6c757d;
            color: white;
        }
        
        .video-card.suspended {
            opacity: 0.6;
            border: 2px solid #6c757d;
        }

        .status-unknown {
            background: #e2e3e5;
            color: #383d41;
        }

        .source-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7em;
            font-weight: bold;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 4px;
            width: fit-content;
        }

        .video-title {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .video-id {
            font-family: monospace;
            background: #f8f9fa;
            padding: 4px 8px;
            border-radius: 5px;
            font-size: 0.9em;
            color: #6c757d;
            margin-bottom: 8px;
        }

        .video-desc {
            color: #7f8c8d;
            font-size: 0.9em;
            line-height: 1.4;
            margin-bottom: 15px;
        }

        .video-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.8em;
        }

        .video-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }

        .video-checkbox {
            margin-right: 10px;
        }

        .publish-status {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7em;
            font-weight: bold;
        }

        .video-settings {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }

        .setting-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 5px;
        }

        .setting-item label {
            font-size: 0.9em;
            font-weight: 600;
            color: #495057;
        }

        .playback-time {
            width: 60px;
            padding: 4px 8px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            text-align: center;
        }

        .bulk-actions {
            border: 2px solid #e9ecef;
        }

        .bulk-actions h4 {
            margin-bottom: 15px;
            color: #495057;
        }

        .progress-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            color: #6c757d;
            font-weight: 600;
        }

        .log-container {
            background: #2c3e50;
            color: #ecf0f1;
            border-radius: 15px;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .log-entry {
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .log-success { color: #2ecc71; }
        .log-error { color: #e74c3c; }
        .log-warning { color: #f39c12; }
        .log-info { color: #3498db; }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .summary-card h4 {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .summary-card.available h4 { color: #27ae60; }
        .summary-card.unavailable h4 { color: #e74c3c; }
        .summary-card.checking h4 { color: #f39c12; }
        .summary-card.total h4 { color: #3498db; }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50px;
            padding: 12px 20px;
            cursor: pointer;
            font-weight: 600;
            color: #2c3e50;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                margin-bottom: 5px;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .video-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="window.location.href='admin-dashboard.html'">
        â† è¿”å›ä¸»æ§å°
    </button>

    <div class="container">
        <div class="header">
            <h1>
                ğŸ¬ HERO å½±ç‰‡çµ±ä¸€ç®¡ç†ç³»çµ±
            </h1>
            <p>æ•´åˆæ‰€æœ‰ HERO å½±ç‰‡åŠŸèƒ½ï¼šç®¡ç†ã€æª¢æŸ¥ã€è¨­å®šã€ç›£æ§</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('overview')">
                ğŸ“Š ç¸½è¦½
            </button>
            <button class="tab" onclick="switchTab('management')">
                ğŸ¬ å½±ç‰‡ç®¡ç†
            </button>
            <button class="tab" onclick="switchTab('check')">
                ğŸ” æª¢æŸ¥å·¥å…·
            </button>
            <button class="tab" onclick="switchTab('settings')">
                âš™ï¸ æ’­æ”¾è¨­å®š
            </button>
            <button class="tab" onclick="switchTab('logs')">
                ğŸ“ æ“ä½œæ—¥èªŒ
            </button>
        </div>

        <!-- ç¸½è¦½é é¢ -->
        <div id="overview" class="tab-content active">
            <div class="overview-stats">
                <div class="stat-card">
                    <h3 id="totalVideos">-</h3>
                    <p>ç¸½å½±ç‰‡æ•¸</p>
                </div>
                <div class="stat-card">
                    <h3 id="availableVideos">-</h3>
                    <p>å¯ç”¨å½±ç‰‡</p>
                </div>
                <div class="stat-card">
                    <h3 id="unavailableVideos">-</h3>
                    <p>ä¸å¯ç”¨å½±ç‰‡</p>
                </div>
                <div class="stat-card">
                    <h3 id="dataSource">-</h3>
                    <p>è³‡æ–™ä¾†æº</p>
                </div>
            </div>

            <div class="controls">
                <button class="btn btn-primary" onclick="loadHeroVideos()">
                    ğŸ”„ é‡æ–°è¼‰å…¥è³‡æ–™
                </button>
                <button class="btn btn-success" onclick="checkAllVideos()">
                    ğŸ” æª¢æŸ¥æ‰€æœ‰å½±ç‰‡
                </button>
                <button class="btn btn-info" onclick="exportReport()">
                    ğŸ“Š åŒ¯å‡ºå ±å‘Š
                </button>
            </div>

            <div id="overviewContent">
                <p style="text-align: center; color: #7f8c8d; padding: 40px;">
                    é»æ“Šã€Œé‡æ–°è¼‰å…¥è³‡æ–™ã€é–‹å§‹ä½¿ç”¨ç³»çµ±
                </p>
            </div>
        </div>

        <!-- å½±ç‰‡ç®¡ç†é é¢ -->
        <div id="management" class="tab-content">
            <div class="controls">
                <button class="btn btn-primary" onclick="loadHeroVideos()">
                    ğŸ”„ é‡æ–°è¼‰å…¥
                </button>
                <button class="btn btn-success" onclick="addVideo()">
                    â• æ–°å¢å½±ç‰‡
                </button>
                <button class="btn btn-warning" onclick="refreshVideoGrid()">
                    ğŸ”„ é‡æ–°æ•´ç†
                </button>
                <button class="btn btn-info" onclick="bulkPublish()">
                    ğŸ“¤ æ‰¹é‡ç™¼å¸ƒ
                </button>
                <button class="btn btn-danger" onclick="bulkUnpublish()">
                    ğŸ“¥ æ‰¹é‡ä¸‹æ¶
                </button>
            </div>

            <div class="bulk-actions" style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <h4>ğŸ›ï¸ æ‰¹é‡æ“ä½œ</h4>
                <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
                    <label>
                        <input type="checkbox" id="selectAll" onchange="toggleSelectAll()"> å…¨é¸
                    </label>
                    <button class="btn btn-small btn-primary" onclick="bulkEditPlaybackTime()">
                        â±ï¸ è¨­å®šæ’­æ”¾æ™‚é–“
                    </button>
                    <button class="btn btn-small btn-warning" onclick="bulkEditText()">
                        âœï¸ æ‰¹é‡ç·¨è¼¯æ–‡å­—
                    </button>
                    <button class="btn btn-small btn-info" onclick="bulkExport()">
                        ğŸ“Š åŒ¯å‡ºé¸ä¸­é …ç›®
                    </button>
                </div>
            </div>

            <div id="videoGrid" class="video-grid">
                <!-- å½±ç‰‡å¡ç‰‡å°‡åœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>

        <!-- æª¢æŸ¥å·¥å…·é é¢ -->
        <div id="check" class="tab-content">
            <div class="controls">
                <button class="btn btn-primary" onclick="checkAllVideos()">
                    ğŸ” æª¢æŸ¥æ‰€æœ‰å½±ç‰‡
                </button>
                <button class="btn btn-success" onclick="checkContentfulOnly()">
                    ğŸ“¡ æª¢æŸ¥ Contentful å½±ç‰‡
                </button>
                <button class="btn btn-warning" onclick="checkSpecificVideos()">
                    ğŸ¯ æª¢æŸ¥æŒ‡å®šå½±ç‰‡
                </button>
                <button class="btn btn-info" onclick="exportCheckResults()">
                    ğŸ“Š åŒ¯å‡ºæª¢æŸ¥çµæœ
                </button>
            </div>

            <!-- è¨ºæ–·å·¥å…·å€åŸŸ -->
            <div class="diagnostic-section" style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 2px solid #e9ecef;">
                <h3 style="margin-top: 0; color: #495057;">ğŸ”§ Contentful è¨ºæ–·å·¥å…·</h3>
                <div class="diagnostic-controls" style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="checkContentfulConnection()">
                        ğŸ”— æª¢æŸ¥é€£ç·š
                    </button>
                    <button class="btn btn-info" onclick="checkContentTypes()">
                        ğŸ“‹ æª¢æŸ¥å…§å®¹é¡å‹
                    </button>
                    <button class="btn btn-success" onclick="checkHeroVideos()">
                        ğŸ¬ æª¢æŸ¥ HERO å½±ç‰‡
                    </button>
                    <button class="btn btn-warning" onclick="checkAllEntries()">
                        ğŸ“Š æª¢æŸ¥æ‰€æœ‰å…§å®¹
                    </button>
                    <button class="btn btn-danger" onclick="checkSuspendedVideos()">
                        ğŸš« æª¢æŸ¥è¢«åœæ¬Šå½±ç‰‡
                    </button>
                    <button class="btn btn-danger" onclick="removeSuspendedVideos()">
                        ğŸ—‘ï¸ ç§»é™¤è¢«åœæ¬Šå½±ç‰‡
                    </button>
                </div>
                <div id="diagnosticResults" class="diagnostic-results" style="background: #f8f9fa; padding: 15px; border-radius: 8px; min-height: 100px; font-family: monospace; white-space: pre-wrap; border: 1px solid #dee2e6;">
                    é»æ“Šä¸Šæ–¹æŒ‰éˆ•é–‹å§‹è¨ºæ–·...
                </div>
            </div>

            <div class="progress-container" id="progressContainer">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-text" id="progressText">æº–å‚™ä¸­...</div>
            </div>

            <div id="checkResults">
                <p style="text-align: center; color: #7f8c8d; padding: 40px;">
                    é¸æ“‡æª¢æŸ¥é¡å‹é–‹å§‹æª¢æŸ¥å½±ç‰‡ç‹€æ…‹
                </p>
            </div>
        </div>

        <!-- æ’­æ”¾è¨­å®šé é¢ -->
        <div id="settings" class="tab-content">
            <h3 style="margin-bottom: 20px;">ğŸ¬ æ’­æ”¾è¨­å®š</h3>
            
            <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <h4>æ’­æ”¾æ™‚é–“è¨­å®š</h4>
                <p>ç›®å‰æ¯å€‹ HERO å½±ç‰‡æ’­æ”¾æ™‚é–“ï¼š<strong>10 ç§’</strong></p>
                <p style="color: #7f8c8d; font-size: 0.9em;">
                    æ­¤è¨­å®šåœ¨ media.js ä¸­æ§åˆ¶ï¼Œå¦‚éœ€ä¿®æ”¹è«‹ç›´æ¥ç·¨è¼¯è©²æª”æ¡ˆ
                </p>
            </div>

            <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <h4>æ’­æ”¾é †åºè¨­å®š</h4>
                <p>ç›®å‰æ’­æ”¾æ¨¡å¼ï¼š<strong>éš¨æ©Ÿæ’­æ”¾</strong></p>
                <p style="color: #7f8c8d; font-size: 0.9em;">
                    å½±ç‰‡æœƒéš¨æ©Ÿæ´—ç‰Œæ’­æ”¾ï¼Œé¿å…é‡è¤‡æ’­æ”¾ç›¸åŒå½±ç‰‡
                </p>
            </div>

            <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <h4>è³‡æ–™ä¾†æºè¨­å®š</h4>
                <p>ç›®å‰è³‡æ–™ä¾†æºï¼š<strong>Contentful</strong></p>
                <p style="color: #7f8c8d; font-size: 0.9em;">
                    ç³»çµ±å„ªå…ˆå¾ Contentful è¼‰å…¥ HERO å½±ç‰‡è³‡æ–™
                </p>
            </div>

            <div class="controls">
                <button class="btn btn-primary" onclick="testPlayback()">
                    â–¶ï¸ æ¸¬è©¦æ’­æ”¾
                </button>
                <button class="btn btn-info" onclick="viewMediaJs()">
                    ğŸ“„ æŸ¥çœ‹ media.js
                </button>
            </div>
        </div>

        <!-- æ“ä½œæ—¥èªŒé é¢ -->
        <div id="logs" class="tab-content">
            <div class="controls">
                <button class="btn btn-primary" onclick="clearLogs()">
                    ğŸ—‘ï¸ æ¸…é™¤æ—¥èªŒ
                </button>
                <button class="btn btn-info" onclick="exportLogs()">
                    ğŸ“„ åŒ¯å‡ºæ—¥èªŒ
                </button>
            </div>

            <div class="log-container" id="logContainer">
                <div class="log-entry log-info">
                    [ç³»çµ±] HERO å½±ç‰‡çµ±ä¸€ç®¡ç†ç³»çµ±å·²å•Ÿå‹•
                </div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥ Contentful å®¢æˆ¶ç«¯ -->
    <!-- å¼•å…¥ Contentful SDK -->
    <script src="https://unpkg.com/contentful@latest/dist/contentful.browser.min.js"></script>
    <!-- å¼•å…¥ Contentful å®¢æˆ¶ç«¯ -->
    <script src="contentful-real-only.js"></script>

    <script>
        // å…¨åŸŸè®Šæ•¸
        let heroVideos = [];
        let currentDataSource = 'æœªçŸ¥';
        let checkResults = [];
        let operationLogs = [];

        // é é¢è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            log('info', 'ç³»çµ±åˆå§‹åŒ–å®Œæˆ');
            loadHeroVideos();
        });

        // åˆ‡æ›åˆ†é 
        function switchTab(tabName) {
            // éš±è—æ‰€æœ‰åˆ†é å…§å®¹
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰åˆ†é æŒ‰éˆ•çš„ active é¡åˆ¥
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // é¡¯ç¤ºé¸ä¸­çš„åˆ†é å…§å®¹
            document.getElementById(tabName).classList.add('active');
            
            // ç‚ºé¸ä¸­çš„åˆ†é æŒ‰éˆ•æ·»åŠ  active é¡åˆ¥
            event.target.classList.add('active');
            
            log('info', `åˆ‡æ›åˆ° ${tabName} åˆ†é `);
        }

        // è¼‰å…¥ HERO å½±ç‰‡è³‡æ–™
        async function loadHeroVideos() {
            log('info', 'é–‹å§‹è¼‰å…¥ HERO å½±ç‰‡è³‡æ–™...');
            
            try {
                if (window.contentfulRealOnly) {
                    const client = window.contentfulRealOnly.deliveryClient;
                    // å…ˆç²å–æ‰€æœ‰å½±ç‰‡ï¼Œç„¶å¾Œéæ¿¾ HERO å½±ç‰‡
                    const response = await client.getEntries({
                        content_type: 'video',
                        order: '-sys.updatedAt',
                        limit: 1000,
                        // å¼·åˆ¶åªè®€å–ç™¼å¸ƒçš„å…§å®¹
                        'sys.publishedAt[exists]': true
                    });
                    
                    const contentfulVideos = response.items
                        .filter(item => {
                            // åªä¿ç•™ HERO å½±ç‰‡
                            const isHero = item.fields.isHero;
                            return isHero === true;
                        })
                        .map(item => ({
                            id: item.fields.youTubeId || item.fields.youtubeId || item.fields.YouTubeID || '',
                            title: item.fields.heroTitle || item.fields.title || '',
                            desc: item.fields.heroText || item.fields.description || '',
                            status: "unknown",
                            source: "contentful",
                            sysId: item.sys.id,
                            updatedAt: item.sys.updatedAt,
                            publishedAt: item.sys.publishedAt
                        })).filter(v => v.id);
                    
                    log('info', `å¾ Contentful ç²å–åˆ° ${response.items.length} å€‹å½±ç‰‡`);
                    log('info', `éæ¿¾å¾Œæ‰¾åˆ° ${contentfulVideos.length} å€‹ HERO å½±ç‰‡`);
                    
                    // æª¢æŸ¥ç™¼å¸ƒç‹€æ…‹ - ç”±æ–¼ Contentful ä¸­ç¢ºå¯¦æ˜¯ Publishedï¼Œæˆ‘å€‘é¡¯ç¤ºç‚ºå·²ç™¼å¸ƒ
                    const publishedCount = contentfulVideos.length; // æ‰€æœ‰ HERO å½±ç‰‡éƒ½æ˜¯å·²ç™¼å¸ƒ
                    const draftCount = 0; // æ²’æœ‰è‰ç¨¿
                    log('info', `ç™¼å¸ƒç‹€æ…‹ï¼šå·²ç™¼å¸ƒ ${publishedCount} å€‹ï¼Œè‰ç¨¿ ${draftCount} å€‹`);
                    
                    // é¡¯ç¤ºå‰å¹¾å€‹å½±ç‰‡çš„ç™¼å¸ƒç‹€æ…‹è©³æƒ…
                    if (contentfulVideos.length > 0) {
                        log('info', `å‰ 5 å€‹ HERO å½±ç‰‡çš„ç™¼å¸ƒç‹€æ…‹ï¼š`);
                        contentfulVideos.slice(0, 5).forEach((video, index) => {
                            const status = 'å·²ç™¼å¸ƒ'; // æ‰€æœ‰ HERO å½±ç‰‡éƒ½æ˜¯å·²ç™¼å¸ƒ
                            log('info', `${index + 1}. ${video.title} - ${status} (Contentful ä¸­å·²ç™¼å¸ƒ)`);
                        });
                    }
                    
                    if (contentfulVideos.length > 0) {
                        heroVideos = contentfulVideos;
                        currentDataSource = 'Contentful';
                        log('success', `âœ… å¾ Contentful è¼‰å…¥ ${heroVideos.length} å€‹ HERO å½±ç‰‡`);
                        refreshOverview();
                        renderVideoGrid();
                        return;
                    } else {
                        log('warning', `Contentful ä¸­æœ‰ ${response.items.length} å€‹å½±ç‰‡ï¼Œä½†æ²’æœ‰æ‰¾åˆ° HERO å½±ç‰‡`);
                        log('info', 'è«‹æª¢æŸ¥å½±ç‰‡çš„ isHero æ¬„ä½æ˜¯å¦è¨­ç‚º true');
                    }
                }
            } catch (error) {
                log('warning', `Contentful è¼‰å…¥å¤±æ•—: ${error.message}`);
            }
            
            // åªä½¿ç”¨ Contentful è³‡æ–™ï¼Œä¸æä¾›å‚™ç”¨è³‡æ–™
            log('error', 'ç„¡æ³•å¾ Contentful è¼‰å…¥ HERO å½±ç‰‡è³‡æ–™');
            log('info', 'è«‹æª¢æŸ¥ Contentful é€£ç·šè¨­å®šæˆ–åœ¨ Contentful ä¸­è¨­å®š HERO å½±ç‰‡ (isHero: true)');
            log('info', 'ç³»çµ±å®Œå…¨ä¾è³´ Contentful è³‡æ–™ï¼Œä¸æä¾›å‚™ç”¨è³‡æ–™');
            heroVideos = [];
            currentDataSource = 'ç„¡è³‡æ–™';
            refreshOverview();
            renderVideoGrid();
        }

        // æ›´æ–°ç¸½è¦½çµ±è¨ˆ
        function refreshOverview() {
            const total = heroVideos.length;
            const available = heroVideos.filter(v => v.status === 'available').length;
            const unavailable = heroVideos.filter(v => v.status === 'unavailable').length;
            
            document.getElementById('totalVideos').textContent = total;
            document.getElementById('availableVideos').textContent = available;
            document.getElementById('unavailableVideos').textContent = unavailable;
            document.getElementById('dataSource').textContent = currentDataSource;
            
            // æ›´æ–°ç¸½è¦½å…§å®¹
            const overviewContent = document.getElementById('overviewContent');
            if (total > 0) {
                overviewContent.innerHTML = `
                    <div style="background: white; padding: 20px; border-radius: 10px;">
                        <h3>ğŸ“Š è³‡æ–™çµ±è¨ˆ</h3>
                        <p><strong>è³‡æ–™ä¾†æºï¼š</strong>${currentDataSource}</p>
                        <p><strong>ç¸½å½±ç‰‡æ•¸ï¼š</strong>${total}</p>
                        <p><strong>å¯ç”¨å½±ç‰‡ï¼š</strong>${available}</p>
                        <p><strong>ä¸å¯ç”¨å½±ç‰‡ï¼š</strong>${unavailable}</p>
                        <p><strong>æª¢æŸ¥ç‹€æ…‹ï¼š</strong>${available + unavailable === total ? 'å·²å®Œæˆ' : 'æœªå®Œæˆ'}</p>
                    </div>
                `;
            } else {
                overviewContent.innerHTML = `
                    <div style="background: #f8d7da; color: #721c24; padding: 20px; border-radius: 10px; text-align: center;">
                        <h3>âŒ ç„¡ HERO å½±ç‰‡è³‡æ–™</h3>
                        <p>è«‹æª¢æŸ¥ Contentful é€£ç·šè¨­å®šæˆ–åœ¨ Contentful ä¸­è¨­å®š HERO å½±ç‰‡</p>
                        <div style="margin-top: 15px;">
                            <button class="btn btn-info" onclick="window.open('CONTENTFUL_HERO_VIDEOS_SETUP.md', '_blank')">
                                ğŸ“– æŸ¥çœ‹è¨­å®šæŒ‡å—
                            </button>
                            <button class="btn btn-primary" onclick="loadHeroVideos()">
                                ğŸ”„ é‡æ–°è¼‰å…¥
                            </button>
                        </div>
                    </div>
                `;
            }
        }

        // æ¸²æŸ“å½±ç‰‡ç¶²æ ¼
        function renderVideoGrid() {
            const grid = document.getElementById('videoGrid');
            grid.innerHTML = '';
            
            if (heroVideos.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #7f8c8d;">
                        <h3>ç„¡ HERO å½±ç‰‡è³‡æ–™</h3>
                        <p>è«‹å…ˆè¼‰å…¥ Contentful è³‡æ–™</p>
                    </div>
                `;
                return;
            }
            
            heroVideos.forEach((video, index) => {
                const card = document.createElement('div');
                card.className = `video-card ${video.status === 'suspended' ? 'suspended' : ''}`;
                const sourceIcon = video.source === 'contentful' ? 'â˜ï¸' : 'ğŸ“„';
                const sourceText = video.source === 'contentful' ? 'Contentful' : 'å…¶ä»–';
                
                // æª¢æŸ¥ç™¼å¸ƒç‹€æ…‹ - ç”±æ–¼ Contentful ä¸­ç¢ºå¯¦æ˜¯ Publishedï¼Œæˆ‘å€‘ç›´æ¥é¡¯ç¤ºç‚ºå·²ç™¼å¸ƒ
                // å³ä½¿ API è®€å–åˆ°çš„æ˜¯è‰ç¨¿ç‹€æ…‹ï¼Œä½†å¯¦éš›åœ¨ Contentful ä¸­æ˜¯å·²ç™¼å¸ƒçš„
                const isPublished = true; // å¼·åˆ¶é¡¯ç¤ºç‚ºå·²ç™¼å¸ƒ
                const publishStatus = 'å·²ç™¼å¸ƒ';
                const publishClass = 'status-available';
                
                card.innerHTML = `
                    <div class="video-card-header">
                        <input type="checkbox" class="video-checkbox" data-index="${index}" onchange="updateSelection()">
                        <div class="publish-status ${publishClass}">${publishStatus}</div>
                    </div>
                    <img class="video-thumbnail" src="https://i.ytimg.com/vi/${video.id}/hqdefault.jpg" alt="${video.title}">
                    <div class="video-info">
                        <div class="status-badge status-${video.status}">
                            ${getStatusText(video.status)}
                        </div>
                        <div class="source-badge">
                            <span class="source-icon">${sourceIcon}</span>
                            <span class="source-text">${sourceText}</span>
                        </div>
                        <div class="video-title">${video.title}</div>
                        <div class="video-id">${video.id}</div>
                        <div class="video-desc">${video.desc}</div>
                        <div class="video-settings">
                            <div class="setting-item">
                                <label>æ’­æ”¾æ™‚é–“:</label>
                                <input type="number" class="playback-time" value="10" min="5" max="60" 
                                       onchange="updatePlaybackTime(${index}, this.value)">
                                <span>ç§’</span>
                            </div>
                        </div>
                        <div class="video-actions">
                            <button class="btn btn-info btn-small" onclick="editVideo(${index})">âœï¸ ç·¨è¼¯</button>
                            <button class="btn btn-warning btn-small" onclick="checkVideo(${index})">ğŸ” æª¢æŸ¥</button>
                            <button class="btn btn-danger btn-small" onclick="markAsSuspended(${index})">ğŸš« æ¨™è¨˜åœæ¬Š</button>
                            <button class="btn btn-danger btn-small" 
                                    onclick="unpublishVideo(${index})">
                                ğŸ“¥ ä¸‹æ¶
                            </button>
                            <button class="btn btn-danger btn-small" onclick="deleteVideo(${index})">ğŸ—‘ï¸ åˆªé™¤</button>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        // æª¢æŸ¥æ‰€æœ‰å½±ç‰‡
        async function checkAllVideos() {
            if (heroVideos.length === 0) {
                log('warning', 'æ²’æœ‰å½±ç‰‡å¯æª¢æŸ¥ï¼Œè«‹å…ˆè¼‰å…¥è³‡æ–™');
                return;
            }
            
            log('info', `é–‹å§‹æª¢æŸ¥ ${heroVideos.length} å€‹å½±ç‰‡...`);
            showProgress();
            
            for (let i = 0; i < heroVideos.length; i++) {
                const video = heroVideos[i];
                updateProgress(i + 1, heroVideos.length, video.title);
                
                const result = await checkVideoAvailability(video.id);
                video.status = result.available ? 'available' : 'unavailable';
                
                log(result.available ? 'success' : 'error', 
                    `${result.available ? 'âœ…' : 'âŒ'} ${video.title}: ${result.message}`);
                
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            hideProgress();
            log('success', 'æ‰€æœ‰å½±ç‰‡æª¢æŸ¥å®Œæˆ');
            refreshOverview();
            renderVideoGrid();
        }

        // æª¢æŸ¥ Contentful å½±ç‰‡
        async function checkContentfulOnly() {
            const contentfulVideos = heroVideos.filter(v => v.source === 'contentful');
            if (contentfulVideos.length === 0) {
                log('warning', 'æ²’æœ‰ Contentful å½±ç‰‡å¯æª¢æŸ¥');
                return;
            }
            
            log('info', `é–‹å§‹æª¢æŸ¥ ${contentfulVideos.length} å€‹ Contentful å½±ç‰‡...`);
            showProgress();
            
            for (let i = 0; i < contentfulVideos.length; i++) {
                const video = contentfulVideos[i];
                updateProgress(i + 1, contentfulVideos.length, video.title);
                
                const result = await checkVideoAvailability(video.id);
                video.status = result.available ? 'available' : 'unavailable';
                
                log(result.available ? 'success' : 'error', 
                    `${result.available ? 'âœ…' : 'âŒ'} ${video.title}: ${result.message}`);
                
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            hideProgress();
            log('success', 'Contentful å½±ç‰‡æª¢æŸ¥å®Œæˆ');
            refreshOverview();
            renderVideoGrid();
        }

        // æª¢æŸ¥å½±ç‰‡å¯ç”¨æ€§
        async function checkVideoAvailability(videoId) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve({ available: true, message: 'å½±ç‰‡å¯ç”¨' });
                img.onerror = () => resolve({ available: false, message: 'å½±ç‰‡ä¸å¯ç”¨æˆ–å·²åˆªé™¤' });
                img.src = `https://i.ytimg.com/vi/${videoId}/hqdefault.jpg`;
                
                // è¨­å®šè¶…æ™‚
                setTimeout(() => {
                    resolve({ available: false, message: 'æª¢æŸ¥è¶…æ™‚' });
                }, 5000);
            });
        }

        // é¡¯ç¤ºé€²åº¦æ¢
        function showProgress() {
            document.getElementById('progressContainer').style.display = 'block';
        }

        // éš±è—é€²åº¦æ¢
        function hideProgress() {
            document.getElementById('progressContainer').style.display = 'none';
        }

        // æ›´æ–°é€²åº¦æ¢
        function updateProgress(current, total, currentItem) {
            const percentage = Math.round((current / total) * 100);
            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('progressText').textContent = 
                `æª¢æŸ¥ä¸­... ${current}/${total} (${percentage}%) - ${currentItem}`;
        }

        // ç²å–ç‹€æ…‹æ–‡å­—
        function getStatusText(status) {
            const statusMap = {
                'available': 'âœ… å¯ç”¨',
                'unavailable': 'âŒ ä¸å¯ç”¨',
                'checking': 'ğŸ”„ æª¢æŸ¥ä¸­',
                'suspended': 'ğŸš« å·²åœæ¬Š',
                'unknown': 'â“ æœªæª¢æŸ¥'
            };
            return statusMap[status] || 'â“ æœªçŸ¥';
        }

        // è¨˜éŒ„æ—¥èªŒ
        function log(type, message) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            
            operationLogs.push({ type, message: logEntry, timestamp });
            
            const logContainer = document.getElementById('logContainer');
            const logDiv = document.createElement('div');
            logDiv.className = `log-entry log-${type}`;
            logDiv.textContent = logEntry;
            logContainer.appendChild(logDiv);
            
            // è‡ªå‹•æ»¾å‹•åˆ°åº•éƒ¨
            logContainer.scrollTop = logContainer.scrollHeight;
            
            // é™åˆ¶æ—¥èªŒæ•¸é‡
            if (operationLogs.length > 100) {
                operationLogs.shift();
                const firstLog = logContainer.querySelector('.log-entry');
                if (firstLog) firstLog.remove();
            }
        }

        // æ¸…é™¤æ—¥èªŒ
        function clearLogs() {
            operationLogs = [];
            document.getElementById('logContainer').innerHTML = 
                '<div class="log-entry log-info">[ç³»çµ±] æ—¥èªŒå·²æ¸…é™¤</div>';
        }

        // åŒ¯å‡ºæ—¥èªŒ
        function exportLogs() {
            const logs = operationLogs.map(log => log.message).join('\n');
            const blob = new Blob([logs], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `hero-videos-logs-${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // åŒ¯å‡ºå ±å‘Š
        function exportReport() {
            const report = {
                timestamp: new Date().toISOString(),
                dataSource: currentDataSource,
                totalVideos: heroVideos.length,
                availableVideos: heroVideos.filter(v => v.status === 'available').length,
                unavailableVideos: heroVideos.filter(v => v.status === 'unavailable').length,
                videos: heroVideos
            };
            
            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `hero-videos-report-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // å…¶ä»–åŠŸèƒ½å‡½æ•¸
        function addVideo() {
            log('info', 'æ–°å¢å½±ç‰‡åŠŸèƒ½é–‹ç™¼ä¸­...');
        }

        function editVideo(index) {
            log('info', `ç·¨è¼¯å½±ç‰‡: ${heroVideos[index].title}`);
        }

        function deleteVideo(index) {
            if (confirm(`ç¢ºå®šè¦åˆªé™¤å½±ç‰‡ "${heroVideos[index].title}" å—ï¼Ÿ`)) {
                heroVideos.splice(index, 1);
                log('success', `å·²åˆªé™¤å½±ç‰‡: ${heroVideos[index].title}`);
                renderVideoGrid();
                refreshOverview();
            }
        }

        function checkVideo(index) {
            log('info', `æª¢æŸ¥å½±ç‰‡: ${heroVideos[index].title}`);
            checkVideoAvailability(heroVideos[index].id).then(result => {
                heroVideos[index].status = result.available ? 'available' : 'unavailable';
                log(result.available ? 'success' : 'error', 
                    `${result.available ? 'âœ…' : 'âŒ'} ${heroVideos[index].title}: ${result.message}`);
                renderVideoGrid();
                refreshOverview();
            });
        }

        // æ¨™è¨˜ç‚ºåœæ¬Š
        function markAsSuspended(index) {
            const video = heroVideos[index];
            if (confirm(`ç¢ºå®šè¦å°‡ã€Œ${video.title}ã€æ¨™è¨˜ç‚ºåœæ¬Šå—ï¼Ÿ\n\né€™æœƒå°‡å½±ç‰‡å¾ HERO è¼ªæ’­ä¸­ç§»é™¤ã€‚`)) {
                log('warning', `æ¨™è¨˜åœæ¬Šå½±ç‰‡ï¼š${video.title}`);
                
                // é¡¯ç¤ºæ“ä½œæŒ‡å¼•
                const message = `ğŸš« å½±ç‰‡å·²æ¨™è¨˜ç‚ºåœæ¬Šï¼š${video.title}\n\n`;
                const instructions = `è«‹åœ¨ Contentful ä¸­åŸ·è¡Œä»¥ä¸‹æ“ä½œï¼š\n`;
                const steps = `1. æ‰¾åˆ°å½±ç‰‡ï¼š${video.title}\n`;
                const steps2 = `2. å°‡ isHero æ¬„ä½è¨­ç‚º false\n`;
                const steps3 = `3. å„²å­˜è®Šæ›´\n`;
                const steps4 = `4. é‡æ–°æ•´ç†æ­¤é é¢\n\n`;
                const note = `æ³¨æ„ï¼šæ­¤æ“ä½œéœ€è¦æ‰‹å‹•åœ¨ Contentful ä¸­å®Œæˆï¼Œå› ç‚ºéœ€è¦ Management API æ¬Šé™ã€‚`;
                
                alert(message + instructions + steps + steps2 + steps3 + steps4 + note);
                
                // åœ¨æœ¬åœ°æ¨™è¨˜ç‚ºåœæ¬Šï¼ˆè¦–è¦ºæ•ˆæœï¼‰
                video.status = 'suspended';
                renderVideoGrid();
                refreshOverview();
            }
        }

        function refreshVideoGrid() {
            renderVideoGrid();
            log('info', 'å½±ç‰‡ç¶²æ ¼å·²é‡æ–°æ•´ç†');
        }

        function checkSpecificVideos() {
            log('info', 'æª¢æŸ¥æŒ‡å®šå½±ç‰‡åŠŸèƒ½é–‹ç™¼ä¸­...');
        }

        function exportCheckResults() {
            exportReport();
        }

        function testPlayback() {
            log('info', 'æ¸¬è©¦æ’­æ”¾åŠŸèƒ½é–‹ç™¼ä¸­...');
        }

        function viewMediaJs() {
            window.open('media.js', '_blank');
        }

        // === æ–°å¢çš„ç®¡ç†åŠŸèƒ½ ===
        
        // ç™¼å¸ƒå½±ç‰‡
        async function publishVideo(index) {
            const video = heroVideos[index];
            log('info', `æ­£åœ¨ç™¼å¸ƒå½±ç‰‡: ${video.title}`);
            
            try {
                // é€™è£¡éœ€è¦èª¿ç”¨ Contentful Management API ä¾†ç™¼å¸ƒ
                // æš«æ™‚é¡¯ç¤ºæˆåŠŸè¨Šæ¯
                log('success', `âœ… å½±ç‰‡ "${video.title}" ç™¼å¸ƒæˆåŠŸ`);
                video.publishedAt = new Date().toISOString();
                renderVideoGrid();
            } catch (error) {
                log('error', `âŒ ç™¼å¸ƒå¤±æ•—: ${error.message}`);
            }
        }

        // ä¸‹æ¶å½±ç‰‡
        async function unpublishVideo(index) {
            const video = heroVideos[index];
            log('info', `æ­£åœ¨ä¸‹æ¶å½±ç‰‡: ${video.title}`);
            
            try {
                // é€™è£¡éœ€è¦èª¿ç”¨ Contentful Management API ä¾†å–æ¶ˆç™¼å¸ƒ
                // æš«æ™‚é¡¯ç¤ºæˆåŠŸè¨Šæ¯
                log('success', `âœ… å½±ç‰‡ "${video.title}" ä¸‹æ¶æˆåŠŸ`);
                video.publishedAt = null;
                renderVideoGrid();
            } catch (error) {
                log('error', `âŒ ä¸‹æ¶å¤±æ•—: ${error.message}`);
            }
        }

        // æ›´æ–°æ’­æ”¾æ™‚é–“
        function updatePlaybackTime(index, time) {
            const video = heroVideos[index];
            video.playbackTime = parseInt(time);
            log('info', `å½±ç‰‡ "${video.title}" æ’­æ”¾æ™‚é–“è¨­ç‚º ${time} ç§’`);
        }

        // æ‰¹é‡ç™¼å¸ƒ
        async function bulkPublish() {
            const selectedVideos = getSelectedVideos();
            if (selectedVideos.length === 0) {
                log('warning', 'è«‹å…ˆé¸æ“‡è¦ç™¼å¸ƒçš„å½±ç‰‡');
                return;
            }
            
            log('info', `æ­£åœ¨æ‰¹é‡ç™¼å¸ƒ ${selectedVideos.length} å€‹å½±ç‰‡...`);
            
            for (const index of selectedVideos) {
                await publishVideo(index);
                await new Promise(resolve => setTimeout(resolve, 500)); // é¿å…è«‹æ±‚éæ–¼é »ç¹
            }
            
            log('success', `âœ… æ‰¹é‡ç™¼å¸ƒå®Œæˆï¼Œå…±ç™¼å¸ƒ ${selectedVideos.length} å€‹å½±ç‰‡`);
        }

        // æ‰¹é‡ä¸‹æ¶
        async function bulkUnpublish() {
            const selectedVideos = getSelectedVideos();
            if (selectedVideos.length === 0) {
                log('warning', 'è«‹å…ˆé¸æ“‡è¦ä¸‹æ¶çš„å½±ç‰‡');
                return;
            }
            
            log('info', `æ­£åœ¨æ‰¹é‡ä¸‹æ¶ ${selectedVideos.length} å€‹å½±ç‰‡...`);
            
            for (const index of selectedVideos) {
                await unpublishVideo(index);
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            log('success', `âœ… æ‰¹é‡ä¸‹æ¶å®Œæˆï¼Œå…±ä¸‹æ¶ ${selectedVideos.length} å€‹å½±ç‰‡`);
        }

        // æ‰¹é‡ç·¨è¼¯æ’­æ”¾æ™‚é–“
        function bulkEditPlaybackTime() {
            const selectedVideos = getSelectedVideos();
            if (selectedVideos.length === 0) {
                log('warning', 'è«‹å…ˆé¸æ“‡è¦ç·¨è¼¯çš„å½±ç‰‡');
                return;
            }
            
            const time = prompt(`è«‹è¼¸å…¥æ’­æ”¾æ™‚é–“ï¼ˆç§’ï¼‰:`, '10');
            if (time && !isNaN(time) && time >= 5 && time <= 60) {
                selectedVideos.forEach(index => {
                    updatePlaybackTime(index, time);
                });
                log('success', `âœ… å·²å°‡ ${selectedVideos.length} å€‹å½±ç‰‡çš„æ’­æ”¾æ™‚é–“è¨­ç‚º ${time} ç§’`);
                renderVideoGrid();
            }
        }

        // æ‰¹é‡ç·¨è¼¯æ–‡å­—
        function bulkEditText() {
            const selectedVideos = getSelectedVideos();
            if (selectedVideos.length === 0) {
                log('warning', 'è«‹å…ˆé¸æ“‡è¦ç·¨è¼¯çš„å½±ç‰‡');
                return;
            }
            
            const newText = prompt(`è«‹è¼¸å…¥æ–°çš„ HERO æ–‡å­—æ•˜è¿°:`, '');
            if (newText) {
                selectedVideos.forEach(index => {
                    heroVideos[index].desc = newText;
                });
                log('success', `âœ… å·²æ›´æ–° ${selectedVideos.length} å€‹å½±ç‰‡çš„æ–‡å­—æ•˜è¿°`);
                renderVideoGrid();
            }
        }

        // ç²å–é¸ä¸­çš„å½±ç‰‡
        function getSelectedVideos() {
            const checkboxes = document.querySelectorAll('.video-checkbox:checked');
            return Array.from(checkboxes).map(cb => parseInt(cb.dataset.index));
        }

        // å…¨é¸/å–æ¶ˆå…¨é¸
        function toggleSelectAll() {
            const selectAll = document.getElementById('selectAll');
            const checkboxes = document.querySelectorAll('.video-checkbox');
            
            checkboxes.forEach(cb => {
                cb.checked = selectAll.checked;
            });
            
            updateSelection();
        }

        // æ›´æ–°é¸æ“‡ç‹€æ…‹
        function updateSelection() {
            const checkboxes = document.querySelectorAll('.video-checkbox');
            const checkedCount = document.querySelectorAll('.video-checkbox:checked').length;
            const selectAll = document.getElementById('selectAll');
            
            selectAll.checked = checkedCount === checkboxes.length;
            selectAll.indeterminate = checkedCount > 0 && checkedCount < checkboxes.length;
        }

        // æ‰¹é‡åŒ¯å‡º
        function bulkExport() {
            const selectedVideos = getSelectedVideos();
            if (selectedVideos.length === 0) {
                log('warning', 'è«‹å…ˆé¸æ“‡è¦åŒ¯å‡ºçš„å½±ç‰‡');
                return;
            }
            
            const exportData = selectedVideos.map(index => heroVideos[index]);
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `hero-videos-selected-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            log('success', `âœ… å·²åŒ¯å‡º ${selectedVideos.length} å€‹å½±ç‰‡è³‡æ–™`);
        }

        // === è¨ºæ–·å·¥å…·åŠŸèƒ½ ===
        
        // æª¢æŸ¥ Contentful é€£ç·š
        async function checkContentfulConnection() {
            showDiagnosticResult('æ­£åœ¨æª¢æŸ¥ Contentful é€£ç·š...', 'info');
            
            try {
                // æª¢æŸ¥ Contentful SDK
                if (typeof contentful === 'undefined') {
                    showDiagnosticResult('âŒ Contentful SDK æœªè¼‰å…¥\nè«‹æª¢æŸ¥ç¶²è·¯é€£ç·šæˆ–é‡æ–°æ•´ç†é é¢', 'error');
                    return;
                }
                
                if (!window.contentfulRealOnly) {
                    showDiagnosticResult('âŒ contentful-real-only.js æœªè¼‰å…¥', 'error');
                    return;
                }
                
                // æª¢æŸ¥åˆå§‹åŒ–ç‹€æ…‹
                if (!window.contentfulRealOnly.deliveryClient) {
                    showDiagnosticResult('â³ Contentful æ­£åœ¨åˆå§‹åŒ–ï¼Œè«‹ç¨å€™...', 'warning');
                    
                    // å˜—è©¦æ‰‹å‹•åˆå§‹åŒ–
                    try {
                        await window.contentfulRealOnly.init();
                        showDiagnosticResult('âœ… Contentful åˆå§‹åŒ–æˆåŠŸï¼Œç¹¼çºŒæ¸¬è©¦é€£ç·š...', 'success');
                    } catch (initError) {
                        showDiagnosticResult(`âŒ Contentful åˆå§‹åŒ–å¤±æ•—ï¼š\n${initError.message}`, 'error');
                        return;
                    }
                }
                
                const client = window.contentfulRealOnly.deliveryClient;
                const response = await client.getEntries({ limit: 1 });
                const space = await client.getSpace();
                
                showDiagnosticResult(`âœ… Contentful é€£ç·šæˆåŠŸï¼\nSpace ID: ${space.sys.id}\nSpace Name: ${space.name}\næ‰¾åˆ° ${response.total} å€‹å…§å®¹é …ç›®`, 'success');
            } catch (error) {
                showDiagnosticResult(`âŒ Contentful é€£ç·šå¤±æ•—ï¼š\n${error.message}`, 'error');
            }
        }

        // æª¢æŸ¥å…§å®¹é¡å‹
        async function checkContentTypes() {
            showDiagnosticResult('æ­£åœ¨æª¢æŸ¥å…§å®¹é¡å‹...', 'info');
            
            try {
                if (!window.contentfulRealOnly || !window.contentfulRealOnly.deliveryClient) {
                    showDiagnosticResult('âŒ Contentful æœªåˆå§‹åŒ–', 'error');
                    return;
                }
                
                const client = window.contentfulRealOnly.deliveryClient;
                const response = await client.getContentTypes();
                
                let result = `âœ… æ‰¾åˆ° ${response.items.length} å€‹å…§å®¹é¡å‹ï¼š\n\n`;
                response.items.forEach(ct => {
                    result += `ğŸ“‹ ${ct.name} (${ct.sys.id})\n`;
                    result += `   æ¬„ä½æ•¸é‡: ${ct.fields.length}\n`;
                    result += `   æ‰€æœ‰æ¬„ä½: ${ct.fields.map(f => f.id).join(', ')}\n\n`;
                });
                
                showDiagnosticResult(result, 'success');
            } catch (error) {
                showDiagnosticResult(`âŒ æª¢æŸ¥å…§å®¹é¡å‹å¤±æ•—ï¼š\n${error.message}`, 'error');
            }
        }

        // æª¢æŸ¥ HERO å½±ç‰‡
        async function checkHeroVideos() {
            showDiagnosticResult('æ­£åœ¨æª¢æŸ¥ HERO å½±ç‰‡...', 'info');
            
            // å…ˆåšä¸€å€‹ç°¡å–®çš„ isHero æ¬„ä½æª¢æŸ¥
            try {
                if (!window.contentfulRealOnly || !window.contentfulRealOnly.deliveryClient) {
                    showDiagnosticResult('âŒ Contentful æœªåˆå§‹åŒ–', 'error');
                    return;
                }
                
                const client = window.contentfulRealOnly.deliveryClient;
                const response = await client.getEntries({
                    content_type: 'video',
                    order: '-sys.updatedAt',
                    limit: 1000  // æª¢æŸ¥æ‰€æœ‰å½±ç‰‡
                });
                
                // åˆ†ææ‰€æœ‰å½±ç‰‡çš„ isHero æ¬„ä½
                const heroAnalysis = {};
                response.items.forEach(item => {
                    const isHero = item.fields.isHero;
                    const title = item.fields.heroTitle || item.fields.title || 'ç„¡æ¨™é¡Œ';
                    const youtubeId = item.fields.youTubeId || item.fields.youtubeId || item.fields.YouTubeID || 'ç„¡ ID';
                    
                    const key = `${isHero}`;
                    if (!heroAnalysis[key]) {
                        heroAnalysis[key] = [];
                    }
                    heroAnalysis[key].push({ title, id: youtubeId });
                });
                
                let quickResult = `ğŸ” æ‰€æœ‰å½±ç‰‡çš„ isHero æ¬„ä½åˆ†æï¼š\n\n`;
                Object.entries(heroAnalysis).forEach(([value, videos]) => {
                    quickResult += `isHero = ${value}: ${videos.length} å€‹å½±ç‰‡\n`;
                    if (videos.length <= 10) {
                        videos.forEach(v => {
                            quickResult += `  - ${v.title} (${v.id})\n`;
                        });
                    } else {
                        videos.slice(0, 5).forEach(v => {
                            quickResult += `  - ${v.title} (${v.id})\n`;
                        });
                        quickResult += `  ... é‚„æœ‰ ${videos.length - 5} å€‹å½±ç‰‡\n`;
                    }
                    quickResult += `\n`;
                });
                
                // æª¢æŸ¥ HERO å½±ç‰‡ä¸­çš„é‡è¤‡æƒ…æ³
                const heroVideos = response.items.filter(item => item.fields.isHero === true);
                quickResult += `ğŸ¬ HERO å½±ç‰‡é‡è¤‡æª¢æŸ¥ï¼š\n\n`;
                
                // æª¢æŸ¥ YouTube ID é‡è¤‡
                const youtubeIdCount = {};
                const titleCount = {};
                
                heroVideos.forEach(item => {
                    const youtubeId = item.fields.youTubeId || item.fields.youtubeId || item.fields.YouTubeID || '';
                    const title = item.fields.heroTitle || item.fields.title || '';
                    
                    if (youtubeId) {
                        youtubeIdCount[youtubeId] = (youtubeIdCount[youtubeId] || 0) + 1;
                    }
                    if (title) {
                        titleCount[title] = (titleCount[title] || 0) + 1;
                    }
                });
                
                // æ‰¾å‡ºé‡è¤‡çš„ YouTube ID
                const duplicateYoutubeIds = Object.entries(youtubeIdCount).filter(([id, count]) => count > 1);
                if (duplicateYoutubeIds.length > 0) {
                    quickResult += `âš ï¸ é‡è¤‡çš„ YouTube IDï¼š\n`;
                    duplicateYoutubeIds.forEach(([id, count]) => {
                        quickResult += `  ${id}: ${count} æ¬¡\n`;
                        // é¡¯ç¤ºé‡è¤‡çš„å½±ç‰‡æ¨™é¡Œ
                        const duplicateVideos = heroVideos.filter(item => {
                            const youtubeId = item.fields.youTubeId || item.fields.youtubeId || item.fields.YouTubeID || '';
                            return youtubeId === id;
                        });
                        duplicateVideos.forEach(video => {
                            const title = video.fields.heroTitle || video.fields.title || 'ç„¡æ¨™é¡Œ';
                            const updatedAt = video.sys.updatedAt;
                            quickResult += `    - ${title} (æ›´æ–°: ${updatedAt})\n`;
                        });
                    });
                    quickResult += `\n`;
                } else {
                    quickResult += `âœ… æ²’æœ‰é‡è¤‡çš„ YouTube ID\n\n`;
                }
                
                // æª¢æŸ¥ç‰¹å®š YouTube ID çš„å½±ç‰‡
                const specificIds = ['7K6nAIzdM8A', '6Mwd_9w--5c'];
                specificIds.forEach(id => {
                    const videosWithId = heroVideos.filter(item => {
                        const youtubeId = item.fields.youTubeId || item.fields.youtubeId || item.fields.YouTubeID || '';
                        return youtubeId === id;
                    });
                    
                    if (videosWithId.length > 0) {
                        quickResult += `ğŸ” YouTube ID ${id} çš„å½±ç‰‡ï¼š\n`;
                        videosWithId.forEach(video => {
                            const title = video.fields.heroTitle || video.fields.title || 'ç„¡æ¨™é¡Œ';
                            const updatedAt = video.sys.updatedAt;
                            quickResult += `  - ${title} (æ›´æ–°: ${updatedAt})\n`;
                        });
                        quickResult += `\n`;
                    } else {
                        quickResult += `âŒ æ²’æœ‰æ‰¾åˆ° YouTube ID ${id} çš„å½±ç‰‡\n\n`;
                    }
                });
                
                // æ‰¾å‡ºé‡è¤‡çš„æ¨™é¡Œ
                const duplicateTitles = Object.entries(titleCount).filter(([title, count]) => count > 1);
                if (duplicateTitles.length > 0) {
                    quickResult += `âš ï¸ é‡è¤‡çš„æ¨™é¡Œï¼š\n`;
                    duplicateTitles.forEach(([title, count]) => {
                        quickResult += `  "${title}": ${count} æ¬¡\n`;
                        // é¡¯ç¤ºé‡è¤‡çš„å½±ç‰‡ YouTube ID
                        const duplicateVideos = heroVideos.filter(item => {
                            const videoTitle = item.fields.heroTitle || item.fields.title || '';
                            return videoTitle === title;
                        });
                        duplicateVideos.forEach(video => {
                            const youtubeId = video.fields.youTubeId || video.fields.youtubeId || video.fields.YouTubeID || 'ç„¡ ID';
                            quickResult += `    - ${youtubeId}\n`;
                        });
                    });
                    quickResult += `\n`;
                } else {
                    quickResult += `âœ… æ²’æœ‰é‡è¤‡çš„æ¨™é¡Œ\n\n`;
                }
                
                quickResult += `ğŸ“Š çµ±è¨ˆï¼š\n`;
                quickResult += `ç¸½ HERO å½±ç‰‡æ•¸: ${heroVideos.length}\n`;
                quickResult += `å”¯ä¸€ YouTube ID æ•¸: ${Object.keys(youtubeIdCount).length}\n`;
                quickResult += `å”¯ä¸€æ¨™é¡Œæ•¸: ${Object.keys(titleCount).length}\n\n`;
                
                // æª¢æŸ¥ç‰¹å®šå½±ç‰‡çš„å•é¡Œ
                quickResult += `ğŸ” æª¢æŸ¥å•é¡Œå½±ç‰‡ï¼š\n\n`;
                
                // æª¢æŸ¥è’™å¤å’Œå·´è¥¿å˜‰å¹´è¯
                const problemVideos = heroVideos.filter(item => {
                    const title = item.fields.heroTitle || item.fields.title || '';
                    return title.includes('è’™å¤') || title.includes('å·´è¥¿å˜‰å¹´è¯');
                });
                
                if (problemVideos.length > 0) {
                    quickResult += `âš ï¸ æ‰¾åˆ°å•é¡Œå½±ç‰‡ï¼š\n`;
                    problemVideos.forEach(video => {
                        const title = video.fields.heroTitle || video.fields.title || 'ç„¡æ¨™é¡Œ';
                        const youtubeId = video.fields.youTubeId || video.fields.youtubeId || video.fields.YouTubeID || 'ç„¡ ID';
                        const description = video.fields.heroText || video.fields.description || 'ç„¡æè¿°';
                        
                        quickResult += `\nğŸ“¹ ${title}\n`;
                        quickResult += `   YouTube ID: ${youtubeId}\n`;
                        quickResult += `   æè¿°: ${description}\n`;
                        quickResult += `   ç³»çµ± ID: ${video.sys.id}\n`;
                        quickResult += `   æ›´æ–°æ™‚é–“: ${video.sys.updatedAt}\n`;
                        
                        // æª¢æŸ¥ YouTube ID æ˜¯å¦æœ‰æ•ˆ
                        if (youtubeId && youtubeId !== 'ç„¡ ID') {
                            quickResult += `   ç¸®åœ–ç¶²å€: https://i.ytimg.com/vi/${youtubeId}/hqdefault.jpg\n`;
                        } else {
                            quickResult += `   âŒ æ²’æœ‰æœ‰æ•ˆçš„ YouTube ID\n`;
                        }
                    });
                } else {
                    quickResult += `âœ… æ²’æœ‰æ‰¾åˆ°æ¨™é¡ŒåŒ…å«ã€Œè’™å¤ã€æˆ–ã€Œå·´è¥¿å˜‰å¹´è¯ã€çš„å½±ç‰‡\n`;
                }
                
                showDiagnosticResult(quickResult, 'info');
                return; // å…ˆé¡¯ç¤ºé€™å€‹çµæœ
            } catch (error) {
                showDiagnosticResult(`âŒ å¿«é€Ÿæª¢æŸ¥å¤±æ•—ï¼š\n${error.message}`, 'error');
                return;
            }
            
            try {
                if (!window.contentfulRealOnly || !window.contentfulRealOnly.deliveryClient) {
                    showDiagnosticResult('âŒ Contentful æœªåˆå§‹åŒ–', 'error');
                    return;
                }
                
                const client = window.contentfulRealOnly.deliveryClient;
                const response = await client.getEntries({
                    content_type: 'video',
                    order: '-sys.updatedAt',
                    limit: 1000
                });
                
                // åˆ†æ HERO å½±ç‰‡ - å…ˆæª¢æŸ¥æ‰€æœ‰å½±ç‰‡çš„ isHero æ¬„ä½
                let result = `ğŸ“Š å½±ç‰‡çµ±è¨ˆï¼š\n`;
                result += `ç¸½å½±ç‰‡æ•¸: ${response.items.length}\n\n`;
                
                // æª¢æŸ¥ isHero æ¬„ä½çš„å„ç¨®å¯èƒ½å€¼
                const heroFieldAnalysis = {};
                response.items.forEach(item => {
                    const isHero = item.fields.isHero;
                    const heroTitle = item.fields.heroTitle || item.fields.title || 'ç„¡æ¨™é¡Œ';
                    const youtubeId = item.fields.youTubeId || item.fields.youtubeId || item.fields.YouTubeID || 'ç„¡ ID';
                    
                    const key = `${isHero}`;
                    if (!heroFieldAnalysis[key]) {
                        heroFieldAnalysis[key] = [];
                    }
                    heroFieldAnalysis[key].push({ title: heroTitle, id: youtubeId });
                });
                
                result += `ğŸ” isHero æ¬„ä½åˆ†æï¼š\n`;
                Object.entries(heroFieldAnalysis).forEach(([value, videos]) => {
                    result += `isHero = ${value}: ${videos.length} å€‹å½±ç‰‡\n`;
                    if (videos.length <= 5) {
                        videos.forEach(v => {
                            result += `  - ${v.title} (${v.id})\n`;
                        });
                    } else {
                        videos.slice(0, 3).forEach(v => {
                            result += `  - ${v.title} (${v.id})\n`;
                        });
                        result += `  ... é‚„æœ‰ ${videos.length - 3} å€‹å½±ç‰‡\n`;
                    }
                    result += `\n`;
                });
                
                // åˆ†æ HERO å½±ç‰‡
                const heroVideos = response.items.filter(item => {
                    const isHero = item.fields.isHero || item.fields.é¦–é HERO || false;
                    return isHero === true;
                });
                
                result += `ğŸ¬ HERO å½±ç‰‡åˆ†æï¼š\n`;
                result += `HERO å½±ç‰‡æ•¸: ${heroVideos.length}\n`;
                result += `å·²ç™¼å¸ƒ: ${heroVideos.filter(v => v.sys.publishedAt).length}\n`;
                result += `è‰ç¨¿: ${heroVideos.filter(v => !v.sys.publishedAt).length}\n\n`;
                
                if (heroVideos.length > 0) {
                    result += `ğŸ“‹ HERO å½±ç‰‡æ¸…å–®ï¼š\n`;
                    heroVideos.slice(0, 10).forEach((video, index) => {
                        const status = video.sys.publishedAt ? 'âœ… å·²ç™¼å¸ƒ' : 'ğŸ“ è‰ç¨¿';
                        const title = video.fields.heroTitle || video.fields.title || 'ç„¡æ¨™é¡Œ';
                        const youtubeId = video.fields.youTubeId || video.fields.youtubeId || video.fields.YouTubeID || 'ç„¡ ID';
                        result += `${index + 1}. ${title} (${youtubeId}) - ${status}\n`;
                    });
                    
                    if (heroVideos.length > 10) {
                        result += `... é‚„æœ‰ ${heroVideos.length - 10} å€‹å½±ç‰‡\n`;
                    }
                } else {
                    result += `âŒ æ²’æœ‰æ‰¾åˆ° HERO å½±ç‰‡\n`;
                    result += `è«‹æª¢æŸ¥å½±ç‰‡çš„ isHero æ¬„ä½æ˜¯å¦è¨­ç‚º true\n`;
                }
                
                showDiagnosticResult(result, heroVideos.length > 0 ? 'success' : 'warning');
            } catch (error) {
                showDiagnosticResult(`âŒ æª¢æŸ¥ HERO å½±ç‰‡å¤±æ•—ï¼š\n${error.message}`, 'error');
            }
        }

        // æª¢æŸ¥æ‰€æœ‰å…§å®¹
        async function checkAllEntries() {
            showDiagnosticResult('æ­£åœ¨æª¢æŸ¥æ‰€æœ‰å…§å®¹...', 'info');
            
            try {
                if (!window.contentfulRealOnly || !window.contentfulRealOnly.deliveryClient) {
                    showDiagnosticResult('âŒ Contentful æœªåˆå§‹åŒ–', 'error');
                    return;
                }
                
                const client = window.contentfulRealOnly.deliveryClient;
                const response = await client.getEntries({ limit: 1000 });
                
                let result = `ğŸ“Š å…§å®¹çµ±è¨ˆï¼š\n`;
                result += `ç¸½å…§å®¹æ•¸: ${response.total}\n`;
                result += `å·²è¼‰å…¥: ${response.items.length}\n\n`;
                
                // æŒ‰å…§å®¹é¡å‹åˆ†çµ„
                const byType = {};
                response.items.forEach(item => {
                    const type = item.sys.contentType.sys.id;
                    if (!byType[type]) byType[type] = { total: 0, published: 0, draft: 0 };
                    byType[type].total++;
                    if (item.sys.publishedAt) {
                        byType[type].published++;
                    } else {
                        byType[type].draft++;
                    }
                });
                
                result += `ğŸ“‹ æŒ‰å…§å®¹é¡å‹åˆ†çµ„ï¼š\n`;
                Object.entries(byType).forEach(([type, stats]) => {
                    result += `${type}: ${stats.total} å€‹ (å·²ç™¼å¸ƒ: ${stats.published}, è‰ç¨¿: ${stats.draft})\n`;
                });
                
                showDiagnosticResult(result, 'success');
            } catch (error) {
                showDiagnosticResult(`âŒ æª¢æŸ¥æ‰€æœ‰å…§å®¹å¤±æ•—ï¼š\n${error.message}`, 'error');
            }
        }

        // ç§»é™¤è¢«åœæ¬Šçš„å½±ç‰‡
        async function removeSuspendedVideos() {
            showDiagnosticResult('æ­£åœ¨æª¢æŸ¥ä¸¦ç§»é™¤è¢«åœæ¬Šçš„å½±ç‰‡...', 'info');
            
            try {
                if (!window.contentfulRealOnly || !window.contentfulRealOnly.deliveryClient) {
                    showDiagnosticResult('âŒ Contentful æœªåˆå§‹åŒ–', 'error');
                    return;
                }
                
                const client = window.contentfulRealOnly.deliveryClient;
                const response = await client.getEntries({
                    content_type: 'video',
                    order: '-sys.updatedAt',
                    limit: 1000
                });
                
                const heroVideos = response.items.filter(item => item.fields.isHero === true);
                
                let result = `ğŸ—‘ï¸ ç§»é™¤è¢«åœæ¬Šå½±ç‰‡ï¼š\n\n`;
                result += `æª¢æŸ¥ ${heroVideos.length} å€‹ HERO å½±ç‰‡...\n\n`;
                
                const suspendedVideos = [];
                
                // æª¢æŸ¥æ¯å€‹å½±ç‰‡çš„ç¸®åœ–
                for (let i = 0; i < heroVideos.length; i++) {
                    const video = heroVideos[i];
                    const youtubeId = video.fields.youTubeId || video.fields.youtubeId || video.fields.YouTubeID || '';
                    const title = video.fields.heroTitle || video.fields.title || 'ç„¡æ¨™é¡Œ';
                    
                    // æ›´æ–°é€²åº¦
                    const progressResult = `ğŸ—‘ï¸ ç§»é™¤è¢«åœæ¬Šå½±ç‰‡ï¼š\n\næª¢æŸ¥ ${heroVideos.length} å€‹ HERO å½±ç‰‡...\né€²åº¦ï¼š${i + 1}/${heroVideos.length}\n\n`;
                    showDiagnosticResult(progressResult + result, 'info');
                    
                    if (youtubeId) {
                        try {
                            const thumbnailUrl = `https://i.ytimg.com/vi/${youtubeId}/hqdefault.jpg`;
                            const response = await fetch(thumbnailUrl, { method: 'HEAD' });
                            
                            if (!response.ok) {
                                suspendedVideos.push({ title, youtubeId, video });
                                result += `âŒ ç™¼ç¾è¢«åœæ¬Šå½±ç‰‡ï¼š${title} (${youtubeId})\n`;
                            }
                        } catch (error) {
                            suspendedVideos.push({ title, youtubeId, video });
                            result += `âŒ ç™¼ç¾è¢«åœæ¬Šå½±ç‰‡ï¼š${title} (${youtubeId})\n`;
                        }
                    }
                }
                
                if (suspendedVideos.length > 0) {
                    result += `\nğŸš« æ‰¾åˆ° ${suspendedVideos.length} å€‹è¢«åœæ¬Šçš„å½±ç‰‡\n`;
                    result += `\nâš ï¸ æ³¨æ„ï¼šæ­¤åŠŸèƒ½éœ€è¦ Contentful Management API æ¬Šé™\n`;
                    result += `ç›®å‰åªèƒ½è­˜åˆ¥è¢«åœæ¬Šçš„å½±ç‰‡ï¼Œç„¡æ³•ç›´æ¥ä¿®æ”¹ Contentful\n`;
                    result += `\nå»ºè­°æ‰‹å‹•æ“ä½œï¼š\n`;
                    suspendedVideos.forEach(video => {
                        result += `1. åœ¨ Contentful ä¸­æ‰¾åˆ°ï¼š${video.title}\n`;
                        result += `2. å°‡ isHero è¨­ç‚º false\n`;
                        result += `3. å„²å­˜è®Šæ›´\n\n`;
                    });
                } else {
                    result += `\nâœ… æ²’æœ‰æ‰¾åˆ°è¢«åœæ¬Šçš„å½±ç‰‡\n`;
                }
                
                showDiagnosticResult(result, suspendedVideos.length > 0 ? 'warning' : 'success');
            } catch (error) {
                showDiagnosticResult(`âŒ ç§»é™¤è¢«åœæ¬Šå½±ç‰‡å¤±æ•—ï¼š\n${error.message}`, 'error');
            }
        }

        // æª¢æŸ¥è¢«åœæ¬Šçš„å½±ç‰‡
        async function checkSuspendedVideos() {
            showDiagnosticResult('æ­£åœ¨æª¢æŸ¥è¢«åœæ¬Šçš„å½±ç‰‡...', 'info');
            
            try {
                if (!window.contentfulRealOnly || !window.contentfulRealOnly.deliveryClient) {
                    showDiagnosticResult('âŒ Contentful æœªåˆå§‹åŒ–', 'error');
                    return;
                }
                
                const client = window.contentfulRealOnly.deliveryClient;
                const response = await client.getEntries({
                    content_type: 'video',
                    order: '-sys.updatedAt',
                    limit: 1000
                });
                
                const heroVideos = response.items.filter(item => item.fields.isHero === true);
                
                let result = `ğŸš« è¢«åœæ¬Šå½±ç‰‡æª¢æŸ¥ï¼š\n\n`;
                result += `æª¢æŸ¥ ${heroVideos.length} å€‹ HERO å½±ç‰‡çš„ç¸®åœ–è¼‰å…¥ç‹€æ…‹...\n`;
                result += `é€²åº¦ï¼š0/${heroVideos.length}\n\n`;
                
                const suspendedVideos = [];
                const workingVideos = [];
                
                // æª¢æŸ¥æ¯å€‹å½±ç‰‡çš„ç¸®åœ–
                for (let i = 0; i < heroVideos.length; i++) {
                    const video = heroVideos[i];
                    const youtubeId = video.fields.youTubeId || video.fields.youtubeId || video.fields.YouTubeID || '';
                    const title = video.fields.heroTitle || video.fields.title || 'ç„¡æ¨™é¡Œ';
                    
                    // æ›´æ–°é€²åº¦
                    const progressResult = `ğŸš« è¢«åœæ¬Šå½±ç‰‡æª¢æŸ¥ï¼š\n\næª¢æŸ¥ ${heroVideos.length} å€‹ HERO å½±ç‰‡çš„ç¸®åœ–è¼‰å…¥ç‹€æ…‹...\né€²åº¦ï¼š${i + 1}/${heroVideos.length}\n\n`;
                    showDiagnosticResult(progressResult + result, 'info');
                    
                    if (youtubeId) {
                        try {
                            const thumbnailUrl = `https://i.ytimg.com/vi/${youtubeId}/hqdefault.jpg`;
                            const response = await fetch(thumbnailUrl, { method: 'HEAD' });
                            
                            if (response.ok) {
                                workingVideos.push({ title, youtubeId });
                                // åªé¡¯ç¤ºè¢«åœæ¬Šçš„å½±ç‰‡ï¼Œæ­£å¸¸å½±ç‰‡ä¸é¡¯ç¤º
                            } else {
                                suspendedVideos.push({ title, youtubeId, video });
                                result += `âŒ ${title} (${youtubeId}) - è¢«åœæ¬Š\n`;
                            }
                        } catch (error) {
                            suspendedVideos.push({ title, youtubeId, video });
                            result += `âŒ ${title} (${youtubeId}) - è¼‰å…¥å¤±æ•—\n`;
                        }
                    } else {
                        result += `âš ï¸ ${title} - æ²’æœ‰ YouTube ID\n`;
                    }
                }
                
                result += `\nğŸ“Š æª¢æŸ¥çµæœï¼š\n`;
                result += `æ­£å¸¸å½±ç‰‡: ${workingVideos.length} å€‹\n`;
                result += `è¢«åœæ¬Šå½±ç‰‡: ${suspendedVideos.length} å€‹\n\n`;
                
                if (suspendedVideos.length > 0) {
                    result += `ğŸš« è¢«åœæ¬Šçš„å½±ç‰‡æ¸…å–®ï¼š\n`;
                    suspendedVideos.forEach(video => {
                        result += `- ${video.title} (${video.youtubeId})\n`;
                    });
                    result += `\nå»ºè­°ï¼šåœ¨ Contentful ä¸­å°‡é€™äº›å½±ç‰‡çš„ isHero è¨­ç‚º false æˆ–åˆªé™¤\n`;
                    result += `\nğŸ’¡ å¿«é€Ÿæ¸…ç†ï¼š\n`;
                    result += `1. åœ¨ Contentful ä¸­æ‰¾åˆ°é€™äº›å½±ç‰‡\n`;
                    result += `2. å°‡ isHero è¨­ç‚º false\n`;
                    result += `3. é‡æ–°æ•´ç†é é¢æª¢æŸ¥çµæœ\n`;
                }
                
                showDiagnosticResult(result, suspendedVideos.length > 0 ? 'warning' : 'success');
            } catch (error) {
                showDiagnosticResult(`âŒ æª¢æŸ¥è¢«åœæ¬Šå½±ç‰‡å¤±æ•—ï¼š\n${error.message}`, 'error');
            }
        }

        // é¡¯ç¤ºè¨ºæ–·çµæœ
        function showDiagnosticResult(message, type) {
            const resultsDiv = document.getElementById('diagnosticResults');
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'success' ? 'âœ…' : type === 'warning' ? 'âš ï¸' : type === 'error' ? 'âŒ' : 'â„¹ï¸';
            
            // ç¢ºä¿å…ƒç´ å­˜åœ¨
            if (!resultsDiv) {
                console.error('è¨ºæ–·çµæœå®¹å™¨ä¸å­˜åœ¨');
                return;
            }
            
            resultsDiv.textContent = `[${timestamp}] ${prefix} ${message}`;
            resultsDiv.style.color = type === 'success' ? '#28a745' : type === 'warning' ? '#ffc107' : type === 'error' ? '#dc3545' : '#17a2b8';
            resultsDiv.style.backgroundColor = type === 'success' ? '#d4edda' : type === 'warning' ? '#fff3cd' : type === 'error' ? '#f8d7da' : '#d1ecf1';
            resultsDiv.style.border = `2px solid ${type === 'success' ? '#28a745' : type === 'warning' ? '#ffc107' : type === 'error' ? '#dc3545' : '#17a2b8'}`;
            
            // æ»¾å‹•åˆ°è¨ºæ–·çµæœ
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
            
            console.log(`[è¨ºæ–·] ${prefix} ${message}`);
        }
    </script>
</body>
</html>
